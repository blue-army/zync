<link href="../../bower_components/iron-ajax/iron-ajax.html" rel="import">

<dom-module id="groups-service">
  <template>

    <iron-ajax id="xhrGroups"
        url={{groupsUrl}}
        handle-as="json"
        on-response="handleResponse"
        on-error="handleError"
        method={{groupsMethod}}
        content-type="application/json"
        body={{groupsBody}}
        debounce-duration="300">
    </iron-ajax>

  </template>
</dom-module>

<script>
  class GroupsService extends Polymer.Element {
    static get is() { return 'groups-service'; }

    static get properties() {
      return {

        groupsUrl: {
          type: String,
          value: "/api/groups"
        },
        groupsMethod: {
          type: String,
          value: "GET",
        },
        groupsBody: {
          type: String,
          value: ""
        },
        auto: {
          type: String,
          observer: "_autoChanged",
        }
      }
    }

    handleResponse(data) {
      // GET for list of groups
      if (this.groupsMethod === "GET") {
      }
      // Create group
      if (this.groupsMethod === "PUT") {
      }
      // DELETE a group
      if (this.groupsMethod === "DELETE") {
      }

      this.dispatchEvent(new CustomEvent('groups-response', data.detail.response));
    }

    handleError(e) {
      console.log(e.detail.error.message);
    }

    _autoChanged() {
      if (this.auto === "true") {
        this.$.xhrGroups.generateRequest();
      }
    }
  }

  customElements.define(GroupsService.is, GroupsService);

</script>
